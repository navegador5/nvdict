const __N=Number,_infi=1/0,__O=Object,__J=JSON,_S$=Symbol,_S=String,_A=Array,_BI=BigInt,U8A=Uint8Array,U16A=Uint16Array,U32A=Uint32Array,BU64A=BigUint64Array,BI64A=BigInt64Array,_pI=parseInt,__t=!0,__f=!1,__un=void 0,__OFE=__O.fromEntries,__OSHI=(_,t)=>t instanceof _,__STST=_S$.toStringTag,__DP="defineProperty",__GOPD="getOwnPropertyDescriptor",__CTOR="constructor",__l="length",__ptyp="prototype",{or,and}=require("nv-facutil-notandor");let __ME=module.exports;const typof=(_,t)=>typeof _===t,instof=(_,t)=>_ instanceof t,eqany=(_,...t)=>{for(var e of t)if(_===e)return!0;return!1};let Node_Util;function is_node(){try{return Node_Util=require("util"),Node_Util.inspect.custom!==__un&&typof(Node_Util.inspect.custom,"symbol")}catch(_){return __f}}const NUL="\0",ZWNJ="‌",ZWJ="‍",BOM="\ufeff",NBSP=" ",LS="\u2028",PS="\u2029";function add_repr(_,t,...e){is_node()?_[__ptyp][Node_Util.inspect.custom]=function(){return t(this,...e)}:_[__ptyp].repr=function(){return t(this,...e)}}function add_string_tag(_,t,...e){__O[__DP](_[__ptyp],__STST,{get:function(){return t(this,...e)}})}function creat_reserved(..._){const t=_S$("");class e{#name;constructor(_,t){this.#name=_}get[t](){return this.#name}}add_repr(e,_=>_[t]),_.forEach(_=>{var t=1===_[__l]?new e(_[0]):_[1];__O[__DP](globalThis,_[0],{value:t,writable:__f,enumerable:__f,configurable:__f})})}function creat_sym_dict(...e){let _=e.map(_=>Symbol(_));return _=_.map((_,t)=>[e[t],_]),Object.fromEntries(_)}const root=_S$("root"),empty=_S$("empty"),unknown=_S$("unknown"),impossible=_S$("impossible"),never=_S$("never"),maybe=_S$("maybe"),any=_S$("any");let _tmp=["init","ready","waiting","executing","pending","paused","skipped","stopped","resolved","rejected","finished","eof"];const STATE_LABEL_DICT=__OFE(_tmp.map(_=>[_,_S$(_)])),STYPE_LABEL_DICT={typ:_S$("type"),k:_S$("key"),tag:_S$("tag"),v:_S$("val")},unescq=_=>__J.parse('"'+_+'"'),jdcp=_=>__J.parse(__J.stringify(_));function _jrplc(t,e,_,i,r){if(is_ary(e))for(let _=0;_<e.length;_++)_jrplc(t,e[_],e,_,_);else if(is_dict(e)){let _=0;for(var n in e)_jrplc(t,e[n],e,_,n),_+=1}else{if(null===_)return t(e,null,null,null);is_ary(_)?_[i]=t(e,i,r,_):_[r]=t(e,i,r,_)}return e}const jrplc=(_,t)=>_jrplc(t,_,null,null,null),jmap=(_,t)=>_jrplc(t,jdcp(_),null,null,null);function iflet(...t){var e=t[__l],_=(t.slice(0,e-1),t[e-1]);for(let _=0;_<e-1;_+=2){var i=t[_],r=t[_+1];if(i)return r}return _}function*_forin(_){for(var t in _)yield[_[t],t]}function forof(_){return _[_S$.iterator]?_:_forin(_)}class SimpleStack extends _A{get lst(){return this[this[__l]-1]}set lst(_){this[this[__l]-1]=_}get top(){return this[this[__l]-1]}set top(_){this[this[__l]-1]=_}get fst(){return this[0]}set fst(_){this[0]=_}get bot(){return this[0]}set bot(_){this[0]=_}*gen_from_lst(){for(let _=this[__l]-1;-1<_;_--)yield this[_]}}function ary_freq(_,t){let e=0;for(var i of _)i===t&&(e+=1);return e}function ary_foreach_brk(t,e,i=(_,t)=>!1){for(let _=0;_<t[__l]&&!i(t[_],_);_++)e(t[_],_)}function ary_foreach_skip(t,e,_=0){for(let _=0;_<t[__l];_++)brkf(t[_],_)||e(t[_],_)}class SimpleMirr extends Map{pair(_){return this.has(_)?new Set([_,this.get(_)]):new Set}set(_,t){super.set(_,t),super.set(t,_)}delete(_){var t=this.get(_);super.delete(_),super.delete(t)}get size(){let _=0;for(var t of this.entries())_=_+1+Number(t[0]===t[1]);return _/2}is_pair(_,t){return this.get(_)===t}}function _creat_nullptr(){var _=__O.create(null);return __O.freeze(_),_}function _creat_none(){class _{}__O[__DP](_,"name",{value:"None"}),add_repr(_,_=>"None");var t=new _;return __O.freeze(t),t}class Nil{}const nfunc=()=>{},None=_creat_none(),nil=_creat_nullptr(),nullptr=_creat_nullptr(),NULL=_creat_nullptr(),is_null=_=>null===_,is_undefined=_=>_===__un,is_nullish=_=>eqany(_,null,__un),nc=(_,t)=>is_nullish(_)?t:_,oc=(t,...e)=>{for(let _=0;_<e[__l]&&(t=t[e[_]])!==__un;_++);return t},is_symbol=_=>typof(_,"symbol"),is_bool=_=>eqany(_,__t,__f),is_int=_=>__N.isInteger(_),is_float=_=>and(is_num(_),!__N.isInteger(_),!is_abnormal_num(_)),is_normal_num=_=>is_num(_)&&!is_abnormal_num(_),is_nan=_=>__N.isNaN(_),is_infinity=_=>eqany(_,_infi,-_infi),is_abnormal_num=_=>__N.isNaN(_)||is_infinity(_),is_num=_=>typof(_,"number")&&!instof(_,__N),is_str=_=>typof(_,"string")&&!instof(_,_S),is_prim=_=>[is_undefined(_),is_null(_),is_bool(_),is_symbol(_),is_num(_),is_str(_)].some(_=>_),is_bigint=_=>typof(_,"bigint");function _add_to_mod_via_oshi(e){for(let t in e){var _="is_"+t;__ME[_]=_=>__OSHI(e[t],_)}}__ME={STATE_LABEL_DICT:STATE_LABEL_DICT,STYPE_LABEL_DICT:STYPE_LABEL_DICT,is_node:is_node,jdcp:jdcp,jrplc:jrplc,jmap:jmap,unescq:unescq,iflet:iflet,forof:forof,typof:typof,instof:instof,eqany:eqany,forlst:(t,e)=>{for(let _=t.length-1;-1<_;_--)e(t[_],_)},d2kvlist:_=>{let t=[],e=[];for(var i in _)t.push(i),e.push(_[i]);return[t,e]},kvlist2d:(t,e)=>{let i={};for(let _=0;_<t.length;_++)i[t[_]]=e[_];return i},dlngth:_=>__O.keys(_).length,dsome:(_,...t)=>{let e={};for(var i of t)_.hasOwnPropert&&(e[i]=_[i]);return e},drekey:(_,...t)=>{let e={},i=0;for(var r in _)e[t[i]]=_[r],i+=1;return e},dreval:(_,...t)=>{let e={},i=0;for(var r in _)e[r]=t[i],i+=1;return e},ary_lst_index:_=>_[__l]-1,get_ary_lst:_=>_[_[__l]-1],set_ary_lst:(_,t)=>{_[_[__l]-1]=t},ary_lsti:_=>_[__l]-1,ary_glst:_=>_[_[__l]-1],ary_slst:(_,t)=>{_[_[__l]-1]=t},ary_ibfr:(_,t,e)=>(_.splice(t,0,e),_),ary_iaft:(_,t,e)=>(_.splice(t+1,0,e),_),ary_rm:(_,t)=>{var e=_[t];return _.splice(t,1),e},ary_fltrg:function*(e,i,r=!1){for(let t=0;t<e[__l];t++){let _=i(e[t],t);_=r?!_:_,_&&(yield[e[t],t])}},ary_freq:ary_freq,ary_foreach_brk:ary_foreach_brk,ary_foreach_skip:ary_foreach_skip,SimpleStack:SimpleStack,SimpleMirr:SimpleMirr,mirr:_=>new SimpleMirr(instof(_,_A)?_.entries():__O.entries(_)),root:root,empty:empty,unknown:unknown,impossible:impossible,never:never,maybe:maybe,any:any,NUL:NUL,NBSP:NBSP,LS:LS,PS:PS,ZWNJ:ZWNJ,ZWJ:ZWJ,BOM:BOM,add_repr:add_repr,add_string_tag:add_string_tag,creat_reserved:creat_reserved,creat_sym_dict:creat_sym_dict,Nil:Nil,nfunc:nfunc,None:None,nil:nil,nullptr:nullptr,NULL:NULL,is_nothing:_=>or(is_nullish(_),_===None,_===nil,_===nullptr,_===NULL,_===empty),optional_chaining:oc,oc:oc,nullish:nc,nc:nc,is_null:is_null,is_undefined:is_undefined,is_nullish:is_nullish,is_symbol:is_symbol,is_bool:is_bool,is_int:is_int,is_float:is_float,is_normal_num:is_normal_num,is_infinity:is_infinity,is_nan:is_nan,is_abnormal_num:is_abnormal_num,is_num:is_num,is_str:is_str,is_prim:is_prim,is_bigint:is_bigint};const _TYPED_FDICT={u8ary:U8A,u8cary:Uint8ClampedArray,u16ary:U16A,u32ary:U32A,i8ary:Int8Array,i16ary:Int16Array,i32ary:Int32Array,f32ary:Float32Array,f64ary:Float64Array,bu64ary:BU64A,bi64ary:BI64A};_add_to_mod_via_oshi(_TYPED_FDICT),__ME.is_typed_ary=_=>{for(var t in _TYPED_FDICT){t="is_"+t;if(__ME[t](_))return __t}return __f};const _INSTOF_FDICT={ary:_A,set:Set,map:Map,wkset:WeakSet,wkmap:WeakMap,wkref:WeakRef,regex:RegExp,date:Date,dv:DataView,arybuf:ArrayBuffer,sarybuf:SharedArrayBuffer};_add_to_mod_via_oshi(_INSTOF_FDICT),__ME.is_weak=_=>or(__ME.is_wkset(_),__ME.is_wkmap(_),__ME.is_wkref(_)),__ME.is_promise=_=>typof(_[__STST],"string")?"promise"===_[__STST].toLowerCase():__f,__ME.is_proxy=_=>{if(is_node()){const t=require("util");return t.types.isProxy(_)}return __f},__ME.is_sync_generator=_=>"Generator"===_[__STST],__ME.is_async_generator=_=>"AsyncGenerator"===_[__STST],__ME.is_generator=_=>__ME.is_sync_generator(_)||__ME.is_async_generator(_),__ME.is_cls_or_func=_=>instof(_,Function),__ME.is_cls=_=>and(__ME.is_cls_or_func(_),!__ME.is_gen(_),!__ME.is_async_func(_),__O[__GOPD](_,"arguments")===__un),__ME.is_lambda=_=>__ME.is_cls_or_func(_)&&__O[__GOPD](_,"prototype")===__un,__ME.is_func=_=>__ME.is_cls_or_func(_)&&__O[__GOPD](_,"arguments")!==__un||is_lambda(_),__ME.is_async_gen=_=>"AsyncGeneratorFunction"===_[__CTOR].name,__ME.is_sync_gen=_=>"GeneratorFunction"===_[__CTOR].name,__ME.is_gen=_=>__ME.is_async_gen(_)||__ME.is_sync_gen(_),__ME.is_async_func=_=>"AsyncFunction"===_[__CTOR].name,__ME.is_normal_func=_=>and(__ME.is_func(_),!__ME.is_gen(_),!__ME.is_async_func(_)),__ME.is_ppg=_=>or(__ME.is_promise(_),__ME.is_generator(_),__ME.is_proxy(_)),__ME.is_dict=_=>and(instof(_,__O),!__ME.is_ary(_),!__ME.is_set(_),!__ME.is_map(_),!__ME.is_wkset(_),!__ME.is_wkmap(_),!__ME.is_wkref(_),!__ME.is_regex(_),!__ME.is_date(_),!__ME.is_dv(_),!__ME.is_arybuf(_),!__ME.is_sarybuf(_),!__ME.is_cls_or_func(_),!__ME.is_typed_ary(_)),__ME.is_normal_dict=_=>!__ME.is_ppg(_)&&__ME.is_dict(_),__ME.is_enum_iter_leaf=_=>or(__ME.is_prim(_),__ME.is_bigint(_),__ME.is_regexp(_),__ME.is_date(_),__ME.is_cls_or_func(_),__ME.is_wkset(_),__ME.is_wkmap(_),__ME.is_wkref(_),__ME.is_dv(_),__ME.is_arybuf(_),__ME.is_sarybuf(_))?__t:__ME.is_ary(_)||__ME.is_typed_ary(_)?0===_[__l]:__ME.is_set(_)||__ME.is_map(_)?0===_.size:0===__O.keys(_)[__l],__ME.is_falsy=_=>or(__ME.is_undefined(_),__ME.is_null(_),eqany(_,0,0n,__f))?__t:__ME.is_ary(_)||__ME.is_typed_ary(_)||__ME.is_str(_)?0===_[__l]:__ME.is_set(_)||__ME.is_map(_)?0===_.size:__ME.is_normal_dict(_)?0===__O.keys(_)[__l]:__ME.is_wkref(_)?__ME.is_falsy(_.deref()):__f,__ME.is_truthy=_=>!__ME.is_falsy(_),_tmp=["undefined","null","symbol","bool","int","float","nan","infinity","str","bigint","u8ary","u8cary","u16ary","u32ary","i8ary","i16ary","i32ary","f32ary","f64ary","bu64ary","bi64ary","ary","set","map","wkset","wkmap","wkref","regex","date","dv","arybuf","sarybuf","promise","proxy","sync_generator","async_generator","normal_dict","cls","sync_gen","async_gen","async_func","normal_func"];const DTYPE_NUM=__OFE(_tmp.map((_,t)=>[_,1n<<_BI(t)]));function _creat_mimp(_){let t=__O.entries(_);_=t.map(_=>[_[1],_[0]]);return new Map(t.concat(_))}__ME.DTYPE_NUM=DTYPE_NUM,__ME.DTYPE_MP=_creat_mimp(DTYPE_NUM),__ME.DTYPE_FDICT=(()=>{let _={};for(var t in DTYPE_NUM){var e="is_"+t,e=__ME[e];_[t]=e}return _})(),__ME.get_dtype=_=>{for(var t in __ME.DTYPE_FDICT)if(__ME.DTYPE_FDICT[t](_))return t},__ME.get_dtype_num=_=>__ME.DTYPE_MP.get(__ME.get_dtype(_)),__ME.STYPE_DICT={root:-1,ele:0,prop:1,stele:2,mpk:3,mpv:4,leaf:5},__ME.STYPE_MP=_creat_mimp(__ME.STYPE_DICT);const{nanoid}=require("nanoid");function _add_creat_id_to_mod(){var _;is_node()&&(_=require("crypto")).randomUUID?(__ME.creat_id=_.randomUUID,__ME.creat_uuid=_.randomUUID):(__ME.creat_id=_tmp,__ME.creat_uuid=_tmp)}_tmp=()=>nanoid(36),_add_creat_id_to_mod(),__ME.creat_guid=_tmp;const ID_REGEX=/\-/g;_tmp=()=>__ME.creat_id().replace(ID_REGEX,""),__ME.creat_nodash_id=_tmp,__ME.creat_idary=()=>[0,0,0,0].map((_,t)=>_pI("0x"+_tmp().slice(8*t,8*t+8))),__ME.creat_bigint_id=()=>_BI("0x"+_tmp()),__ME.get_abbr=_=>_.substr(0,8);const _idpool_repr=_=>({minid_:_.minid_,maxid_:_.maxid_,used_:_.used_,lefted_:_.lefted_});function*_snid_gen(t,e,i){for(;__t;){e.size===t&&(yield-i);for(let _=i;_<=t;_++)e.has(_)||(e.add(_),yield _)}}class SNidPool{#rented;#maxid;#one;#g;constructor(_,t=new Set){this.#maxid=_??SNidPool.SQUARE_MAXID,is_bigint(_)?this.#one=1n:this.#one=1,this.#rented=t,this.#g=_snid_gen(this.#maxid,this.#rented,this.#one)}get minid_(){return this.#one}get maxid_(){return this.#maxid}get used_(){return this.#rented.size}get lefted_(){return this.#maxid-this.#rented.size}is_full(){return 0===this.lefted_}rent(){return this.#g.next().value}rtrn(_){this.#rented.delete(_)}reset(){for(var _ of this.#rented)this.#rented.delete(_);this.#g=_snid_gen(this.#maxid,this.#rented,this.#one)}}SNidPool.SQUARE_MAXID=Math.floor(Math.sqrt(__N.MAX_SAFE_INTEGER)),add_repr(SNidPool,_idpool_repr),__ME.SNidPool=SNidPool;function*_anid_gen(_,t,e,i){for(var r=t[__l];__t;)for(let _=1;_<r;_++)t[_]!==e||(t[_]=i,yield _)}function _creat_anid_cls(r){const _=_S$(),t=_S$(),e=_S$(),i=_S$(),n=_S$(),s=_S$(),a=_S$();class o{#rented;#maxid;#g;#used;#empty;#initv;constructor(_,t,e,i){t=r===_A?t??_A.from({length:_pI(_+1)}).map(_=>e):t??new r(_pI(_+1)),this.#maxid=r===BU64A?_BI(_):_,this.#used=t.filter(_=>_!==e).length,this.#rented=t,this.#empty=e,this.#initv=i,this.#g=_anid_gen(_pI(_),this.#rented,this.#empty,this.#initv)}get rented_(){return this.#rented}[_](){this.#used=this.#used+1}[t](){this.#used=this.#used-1}get used_(){return this.#used}get minid_(){return r===BU64A?1n:1}get maxid_(){return this.#maxid}get lefted_(){return _pI(this.#maxid)-this.used_}is_full(){return 0===this.lefted_}get[e](){return this.#empty}get[i](){return this.#rented}get[n](){return this.#initv}get[s](){return this.#g}[a](){this.#g=_anid_gen(_pI(this.#maxid),this.#rented,this.#empty,this.#initv)}reset(){this.#used=0;for(let _=1;_<this.#rented[__l];_++)this.#rented[_]=this.#empty;this[a]()}}return r===BU64A?(o[__ptyp].rent=function(){return this.used_===_pI(this.maxid_)?(this[a](),-this[n]):(this[_](),_BI(this[s].next().value))},o[__ptyp].rtrn=function(_){this[i][_pI(_)]!==this[e]&&(this[t](),this[i][_pI(_)]=this[e])}):(o[__ptyp].rent=function(){return this.used_===this.maxid_?(this[a](),-this[n]):(this[_](),this[s].next().value)},o[__ptyp].rtrn=function(_){this[i][_]!==this[e]&&(this[t](),this[i][_]=this[e])}),add_repr(o,_idpool_repr),o}__ME.AidPool=_creat_anid_cls(_A),__ME.T8AidPool=_creat_anid_cls(U8A),__ME.T16AidPool=_creat_anid_cls(U16A),__ME.T32AidPool=_creat_anid_cls(U32A),__ME.T64AidPool=_creat_anid_cls(BU64A),module.exports=__ME;